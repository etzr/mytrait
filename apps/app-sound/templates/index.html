{% extends 'layout.html' %}
{% block header %}
    <title>Pitch Perfect</title>
    <style>    
        .flex-container-column {
            display: flex;
            flex-flow: column nowrap;
            height: 100%;
            margin: 0;
            padding:0;
        }
        .flex-container-row {
            display: flex;
            flex-flow: row nowrap;
            width: 100%;
            margin: 0;
            padding:0;
        }

        .row.progress {
            order: 1;
            flex-grow: 0;
            margin: 0;
        }
        .row.content {
            order: 2;
            flex-grow: 1;
            margin: 0;
        }

        .center { 
            justify-content: center; 
        }
        .disabled {
            background-color: #979c99;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="flex-container-column">
        <div class="row progress">
            <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
        </div>

        <div class="row content"> 
            <div class="flex-container-row center">
                <div class="flex-container-column center" style="padding-left: 50px; padding-right: 50px"> 
                    <h1 style="font-size:20em; text-align: center">
                        <i class="fas fa-assistive-listening-systems"></i>
                    </h1>

                    <span style="font-size:3em; text-align: center" id="instruction">
                        You will be tested on <b>3 levels</b> to determine how <b>Pitch Perfect</b> you are.
                    </span>   
                    <div style="height: 100px"></div>
                    <button type="button" id="start_btn" class="btn btn-success" style="font-size:5em" onclick="countdown()">Start</button>
                </div>
            </div>
        </div>  
    </div>
    <script type="text/javascript">
        function play_file(file) {
            file_path = 'static/audio/notes/' + file
            var audio = new Audio(file_path);
            audio.play();
        }

        function countdown() {
            $("#instruction").html("You are now hearing the Middle C (C5)")
            play_file("60.wav");
            
            $("#start_btn").addClass("disabled")
            $("#start_btn").prop("onclick", null).off("click")

            var time = 4;
            var interval = setInterval(function() { 
                if (time > 0) {      
                    $("#start_btn").html(time);      
                    time = time - 1;
                }
                else { 
                    window.location.replace("{{url_for('level1')}}");
                }
            }, 1000);
        }
    </script>
{% endblock %}